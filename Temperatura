#include
#include
#define sensor 0
#include
int Ventrada; 
float Temperatura; 
char Temp[10];
String var;
byte mac[] = { 0x90, 0xA2, 0xda, 0x0d, 0xff, 0x81 };
byte ip[] = {10,6,11,253};
byte gateway[] = { 10, 6, 192, 172 };
byte subnet[] = { 255, 255, 0, 0 };
IPAddress server(189,20,93,243); // NÃºmero IP do WebService
EthernetClient client;


void setup() {
Serial.begin(9600);

if (Ethernet.begin(mac) == 0) {
Serial.println("Failed");
Ethernet.begin(mac, ip, gateway, subnet);
}
// give the Ethernet shield a second to initialize:
delay(1000);
Serial.println("connecting...");

}
void loop()
{
client.stop();
Ethernet.begin(mac,ip);

Ventrada = analogRead (sensor);
Temperatura=(500*Ventrada)/1023;
Serial.println(Temperatura);
dtostrf(Temperatura, 1, 2, Temp);
Serial.println(Temp);
String ini = "sensor=1&valor=";
var = ini + Temp;
Serial.println(var);


if (client.connect(server, 11003)) {
Serial.println("connected");
client.println("POST /ImgSensor/rst/valsensor.ashx? HTTP/1.1");
client.println("Host: localhost");
client.println("Content-Type: application/x-www-form-urlencoded");
client.println("Content-Length: 342");
client.println();
client.println(var);
}
else {
Serial.println("connection failed");
}

if (client.available()) {
char c = client.read();
Serial.print(c);
}
// if the server's disconnected, stop the client:
if (!client.connected()) {
Serial.println();
Serial.println("disconnecting.");
}
delay(20000);
}
